<div style="background-color: #f6f6f6 !important;">
  <div class="header">
    <nav class="navbar navbar-expand-lg navbar-light bg-light"
      style="box-shadow: 0px 0px 20px 0px #e5e2e2; background: #FFF !important;">
      <!--<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown"
      aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavDropdown">-->

      <ul class="navbar-nav">
        <li class="nav-item active">
          <img class="app-logo" src="assets/home_images/AiAuraF2.svg" alt="">
        </li>
        <li class="nav-item d-flex nav-list-item">
          <h5>John Doe</h5>
          <div>
            <img src="assets/home_images/Profile.png" alt="">
          </div>
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="false" (click)="toggleLogoutButton($event)"
            style=" padding: 10px 24px 10px 16px;">
            {{ isLogoutButtonVisible ? '' : '' }}
            <!-- {{ isLogoutButtonVisible ? 'Logout' : '' }} -->
          </a>
          <div class="dropdown-menu logout-btn" aria-labelledby="navbarDropdownMenuLink"
            [ngClass]="{'show': isLogoutButtonVisible}" (click)="preventClose($event)">
            <a class="dropdown-item" (click)="logout()"><i class="fa fa-user"
                style="padding:10px 24px 10px 16px"></i>Logout</a>
          </div>
        </li>
      </ul>
      <!--</div>-->
    </nav>
  </div>

  <div class="container">
    <div class="home">
      <h3 style="text-align: center;" class="carousel-title" *ngIf="isSendingMessage">Labour Law Bot</h3>
      <ngb-carousel *ngIf="isCarouselVisible">
        <ng-template ngbSlide *ngFor="let image of images">
          <div class="card main">
            <div class="wrapper">
              <div class="carousel-caption title">
                <div class="row">
                  <div class="col-md-6 carousel-data">
                    <div class="">
                      <h3>{{ image.title }}</h3>
                      <div class="description">
                        <p class="carousel-text mt-4">
                          {{ image.description }}
                        </p>
                        <div class="img-1">
                          <img src="assets/home_images/Ornament 82.png" alt="">
                        </div>
                        <div class="img-2">
                          <img src="assets/home_images/Ornament 16.png" alt="">
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="carousel-img-wrapper">
                      <div class="carousel-img1">
                        <img src="assets/home_images/Ornament 11.png" alt="">
                      </div>
                      <div class="carousel-img2">
                        <img [src]="image.src1" alt="Random first slide">
                      </div>
                      <div class="carousel-img3">
                        <img [src]="image.src2" alt="Random second slide">
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </ng-template>
      </ngb-carousel>
      <div class="container h-100">
        <div class="chat-container" (scroll)="onChatScroll()" #chatContainer>
          <div class="chat-messages">
            <div *ngFor="let message of chatMessages; let i = index" class="message-container">
              <div class="row">
                <div class="col-md-12">
                  <div *ngIf="isMessageSent" class="sent-message">
                    <img src="assets/home_images/Profile.png" alt="" class="profile-image">
                    <span>{{ sentMessage }}</span>
                    <div class="question" *ngIf="!message.editMode">{{ message.question }}</div>
                    <!--<input [(ngModel)]="message.question" *ngIf="message.editMode" class="QuestionInput" />-->
                    <textarea [(ngModel)]="message.question" *ngIf="message.editMode" class="QuestionInput"
                      style="height: 60px; overflow-y: hidden;" (keydown.enter)="submitQuestion(message,i)" (input)="adjustTextareaHeight(expandingTextarea)"
                      #expandingTextarea></textarea>


                    <div *ngIf="!message.editMode" class="ms-auto edit-question">
                      <svg class="edit-icon" (click)="editQuestion(message)" xmlns="http://www.w3.org/2000/svg"
                        width="24" height="24" viewBox="0 0 24 24" fill="none">
                        <title>Edit</title>
                        <path fill-rule="evenodd" clip-rule="evenodd"
                          d="M15.419 3.67708C16.3218 2.77431 17.7855 2.77431 18.6883 3.67708L20.3229 5.31171C21.2257 6.21449 21.2257 7.67818 20.3229 8.58096L18.8736 10.0303C18.7598 9.97394 18.6401 9.91302 18.516 9.84767C17.6806 9.40786 16.6892 8.79057 15.9493 8.05069C15.2095 7.31082 14.5922 6.31945 14.1524 5.48403C14.087 5.35989 14.0261 5.24018 13.9697 5.12639L15.419 3.67708ZM14.8887 9.11135C15.7642 9.98687 16.8777 10.6759 17.7595 11.1444L12.06 16.8438C11.7064 17.1975 11.2475 17.4269 10.7523 17.4977L7.31963 17.9881C6.5568 18.097 5.90295 17.4432 6.01193 16.6804L6.50231 13.2477C6.57305 12.7525 6.80248 12.2936 7.15616 11.94L12.8556 6.24053C13.3241 7.12234 14.0131 8.23582 14.8887 9.11135ZM3.75 19.5C3.33579 19.5 3 19.8358 3 20.25C3 20.6642 3.33579 21 3.75 21H20.25C20.6642 21 21 20.6642 21 20.25C21 19.8358 20.6642 19.5 20.25 19.5H3.75Z"
                          fill="#1C2F72" />
                      </svg>
                    </div>

                  </div>
                  <div class="actions" *ngIf="!message.editMode">
                    <div class="aura">
                      <img src="assets/home_images/Aura.png" alt="">
                    </div>

                    <!--Printing the edited question's answer-->
                    <span class="type-animation"
                      *ngIf="isChatLoading && editingIndex!==null && editingIndex===i"><span>Generating
                        Response...<span class="cursor-animation">|</span></span>
                    </span>
                    <ngx-typed-js *ngIf="(editingIndex!==null && editingIndex===i)" [showCursor]="false"
                      [typeSpeed]="75" [strings]="[message.answer]" [contentType]="'html'" (started)="onTypingStart()"
                      (completed)="onTypingStop()">
                      <span class="typing"></span>
                    </ngx-typed-js>

                    <!--Printing the latest question's answer-->
                    <span class="type-animation"
                      *ngIf="isChatLoading && currentIndex-1==i && editingIndex===null"><span>Generating
                        Response...<span class="cursor-animation">|</span></span>
                    </span>

                    <ngx-typed-js *ngIf="currentIndex-1===i && editingIndex===null" [showCursor]="false"
                      [typeSpeed]="75" [strings]="[message.answer]" [contentType]="'html'" (started)="onTypingStart()"
                      (completed)="onTypingStop()">
                      <span class="typing"></span>
                    </ngx-typed-js>

                    <!-- Printing the latest answer when any other question other than latest is edited-->
                    <span style="width: 70%;padding: 5px;" class="editQuestion(i)"
                      *ngIf="currentIndex-1 == i && editingIndex!==null && currentIndex-1!==editingIndex"><span>{{message.answer.split(dummy)[0]}}</span><br
                        *ngIf="message.source"><span *ngIf="message.source">Citation: <a
                          [href]="'https://auraf2-dev.mouritech.net/app/Policies/search/' + message.source"
                          target="_blank">{{message.source}}</a>
                      </span>
                    </span>

                    <!-- Printing the answer which is not latest or edited-->
                    <span style="width: 70%;padding: 5px;" class="editQuestion(i)"
                      *ngIf="currentIndex-1 !== i && (editingIndex===null || editingIndex!==i)"><span>{{message.answer.split(dummy)[0]}}</span><br
                        *ngIf="message.source"><span *ngIf="message.source">Citation: <a
                          [href]="'https://auraf2-dev.mouritech.net/app/Policies/search/' + message.source"
                          target="_blank">{{message.source}}</a>
                      </span>
                    </span>
                    <br>
                    <div class="answer-icons ms-auto" *ngIf="showIcons && message.answer != '' ">
                      <svg *ngIf="!isCopying[i]" title="Copy" class="copy-icon" xmlns="http://www.w3.org/2000/svg" width="24"
                        height="24" viewBox="0 0 24 24" fill="none" (click)="copyToClipboard(message.answer,i)">
                        <title>Copy</title>
                        <path opacity="0.4"
                          d="M8 6C8 3.79086 9.79086 2 12 2H18C20.2092 2 22 3.79086 22 6V12C22 14.2091 20.2092 16 18 16H12C9.79086 16 8 14.2091 8 12V6Z"
                          fill="#1C2F72" />
                        <path
                          d="M2 12C2 9.79086 3.79086 8 6 8H12C14.2092 8 16 9.79086 16 12V18C16 20.2091 14.2092 22 12 22H6C3.79086 22 2 20.2091 2 18V12Z"
                          fill="#1C2F72" />
                      </svg>
                      <svg *ngIf="isCopying[i]" title="Copied" class="copied-icon" xmlns="http://www.w3.org/2000/svg" width="24"
                        height="24" viewBox="0 0 24 24" fill="none">
                        <title>Copied</title>
                        <path fill-rule="evenodd" clip-rule="evenodd"
                          d="M18 2H6C3.79086 2 2 3.79086 2 6V18C2 20.2091 3.79086 22 6 22H18C20.2091 22 22 20.2091 22 18V6C22 3.79086 20.2091 2 18 2ZM16.592 9.46049C16.8463 9.13353 16.7874 8.66232 16.4605 8.40802C16.1335 8.15372 15.6623 8.21262 15.408 8.53958L11.401 13.6914C11.3119 13.806 11.1443 13.8209 11.0364 13.7238L8.50173 11.4426C8.19385 11.1655 7.71963 11.1904 7.44254 11.4983C7.16544 11.8062 7.1904 12.2804 7.49828 12.5575L10.033 14.8387C10.7881 15.5183 11.9613 15.4143 12.585 14.6123L16.592 9.46049Z"
                          fill="#1C2F72" />
                      </svg>
                      <svg (click)="likeMessage()" title="Like" class="like-icon" xmlns="http://www.w3.org/2000/svg" width="24"
                        height="24" viewBox="0 0 24 24" fill="none">
                        <title>Like</title>
                        <path fill-rule="evenodd" clip-rule="evenodd"
                          d="M12.7111 21H15.8769C17.7124 21 19.3123 19.7508 19.7575 17.9701L21.3788 11.4851C21.6943 10.2228 20.7396 9 19.4385 9H14.5L15.8069 6.75968C16.7791 5.09303 15.5769 3 13.6474 3H12.5L8.63178 9.76943C8.54543 9.92052 8.50002 10.0915 8.50002 10.2656V18.4648C8.50002 18.7992 8.66712 19.1114 8.94532 19.2969L10.4923 20.3282C11.1494 20.7662 11.9214 21 12.7111 21ZM4 9H5C6.10457 9 7 9.89543 7 11V18C7 19.1046 6.10457 20 5 20H4C2.89543 20 2 19.1046 2 18V11C2 9.89543 2.89543 9 4 9Z"
                          fill="#1C2F72" />
                      </svg>
                      <svg (click)="dislikeMessage()" title="Dislike" class="dislike-icon" xmlns="http://www.w3.org/2000/svg" width="24"
                        height="24" viewBox="0 0 24 24" fill="none">
                        <title>Dislike</title>
                        <path fill-rule="evenodd" clip-rule="evenodd"
                          d="M11.2889 3H8.12309C6.28761 3 4.68768 4.24919 4.24252 6.02986L2.62125 12.5149C2.30567 13.7772 3.26039 15 4.56153 15H9.49998L8.19312 17.2403C7.22092 18.907 8.42309 21 10.3526 21H11.5L15.3682 14.2306C15.4546 14.0795 15.5 13.9085 15.5 13.7344V5.53518C15.5 5.20083 15.3329 4.8886 15.0547 4.70313L13.5077 3.6718C12.8506 3.23375 12.0786 3 11.2889 3ZM20 15H19C17.8954 15 17 14.1046 17 13V6C17 4.89543 17.8954 4 19 4H20C21.1046 4 22 4.89543 22 6V13C22 14.1046 21.1046 15 20 15Z"
                          fill="#1C2F72" />
                      </svg>
                    </div>
                  </div>
                </div>
              </div>
              <app-dialogue *ngIf="showDialogueBox" (cancelClicked)="onCancelClicked($event)"></app-dialogue>
              <app-dislike *ngIf="showDislikeBox" (cancelDislike)="cancelButtonClick($event)"></app-dislike>
              <div *ngIf="message.editMode" class="edit-btn-group">
                <button class="submit-button" (click)="submitQuestion(message,i)">Submit</button>
                <button class="cancel-button" (click)="cancelEdit(message,i)">Cancel</button>
              </div>
              <div class="row position-relative">
                <div class="col-md-12">
                  <div class="actions" *ngIf="message.editMode && message.answer">
                    <div class="aura">
                      <img src="assets/home_images/Aura.png" alt="">
                    </div>
                    <div class="edit-mode-answer">
                      <span class="" [innerHTML]="message.answer"><br></span>
                    </div>
                    <div class="answer-icons ms-auto icons">
                      <svg *ngIf="!isCopying[i]" title="Copy" class="copy-imgs" xmlns="http://www.w3.org/2000/svg" width="24"
                        height="24" viewBox="0 0 24 24" fill="none" (click)="copyToClipboard(message.answer,i)">
                        <title>Copy</title>
                        <path opacity="0.4"
                          d="M8 6C8 3.79086 9.79086 2 12 2H18C20.2092 2 22 3.79086 22 6V12C22 14.2091 20.2092 16 18 16H12C9.79086 16 8 14.2091 8 12V6Z"
                          fill="#1C2F72" />
                        <path
                          d="M2 12C2 9.79086 3.79086 8 6 8H12C14.2092 8 16 9.79086 16 12V18C16 20.2091 14.2092 22 12 22H6C3.79086 22 2 20.2091 2 18V12Z"
                          fill="#1C2F72" />
                      </svg>
                      <svg *ngIf="isCopying[i]" title="Copied" class="copied-img" xmlns="http://www.w3.org/2000/svg" width="24"
                        height="24" viewBox="0 0 24 24" fill="none">
                        <title>Copied</title>
                        <path fill-rule="evenodd" clip-rule="evenodd"
                          d="M18 2H6C3.79086 2 2 3.79086 2 6V18C2 20.2091 3.79086 22 6 22H18C20.2091 22 22 20.2091 22 18V6C22 3.79086 20.2091 2 18 2ZM16.592 9.46049C16.8463 9.13353 16.7874 8.66232 16.4605 8.40802C16.1335 8.15372 15.6623 8.21262 15.408 8.53958L11.401 13.6914C11.3119 13.806 11.1443 13.8209 11.0364 13.7238L8.50173 11.4426C8.19385 11.1655 7.71963 11.1904 7.44254 11.4983C7.16544 11.8062 7.1904 12.2804 7.49828 12.5575L10.033 14.8387C10.7881 15.5183 11.9613 15.4143 12.585 14.6123L16.592 9.46049Z"
                          fill="#1C2F72" />
                      </svg>
                      <svg (click)="likeMessage()" title="Like" class="like-imgs" xmlns="http://www.w3.org/2000/svg" width="24"
                        height="24" viewBox="0 0 24 24" fill="none">
                        <title>Like</title>
                        <path fill-rule="evenodd" clip-rule="evenodd"
                          d="M12.7111 21H15.8769C17.7124 21 19.3123 19.7508 19.7575 17.9701L21.3788 11.4851C21.6943 10.2228 20.7396 9 19.4385 9H14.5L15.8069 6.75968C16.7791 5.09303 15.5769 3 13.6474 3H12.5L8.63178 9.76943C8.54543 9.92052 8.50002 10.0915 8.50002 10.2656V18.4648C8.50002 18.7992 8.66712 19.1114 8.94532 19.2969L10.4923 20.3282C11.1494 20.7662 11.9214 21 12.7111 21ZM4 9H5C6.10457 9 7 9.89543 7 11V18C7 19.1046 6.10457 20 5 20H4C2.89543 20 2 19.1046 2 18V11C2 9.89543 2.89543 9 4 9Z"
                          fill="#1C2F72" />
                      </svg>
                      <svg (click)="dislikeMessage()" title="Dislike" class="dislike-imgs" xmlns="http://www.w3.org/2000/svg" width="24"
                        height="24" viewBox="0 0 24 24" fill="none">
                        <title>Dislike</title>
                        <path fill-rule="evenodd" clip-rule="evenodd"
                          d="M11.2889 3H8.12309C6.28761 3 4.68768 4.24919 4.24252 6.02986L2.62125 12.5149C2.30567 13.7772 3.26039 15 4.56153 15H9.49998L8.19312 17.2403C7.22092 18.907 8.42309 21 10.3526 21H11.5L15.3682 14.2306C15.4546 14.0795 15.5 13.9085 15.5 13.7344V5.53518C15.5 5.20083 15.3329 4.8886 15.0547 4.70313L13.5077 3.6718C12.8506 3.23375 12.0786 3 11.2889 3ZM20 15H19C17.8954 15 17 14.1046 17 13V6C17 4.89543 17.8954 4 19 4H20C21.1046 4 22 4.89543 22 6V13C22 14.1046 21.1046 15 20 15Z"
                          fill="#1C2F72" />
                      </svg>
                    </div>
                  </div>
                </div>

              </div>
            </div>
          </div>
        </div>
      </div>
      <!--<div class="input-container SendMessage">-->
      <div class="prompt-textarea-container">
        <button class="regenerate-button" *ngIf="isMessageGenerated" (click)="toggleGenerating()">
          {{ isStopGeneratingVisible ? 'Stop Generating' : 'Regenerate' }}
        </button> 
        <textarea id="prompt-textarea" row="1" class="text-input" [(ngModel)]="userInput"
          (input)="toggleSendButton();adjustTextareaHeight(scrollingTextarea,4)" (keydown.enter)="sendMessage()"
          placeholder="Send a message" [ngClass]="{ 'highlight': isSendButtonEnabled }"
          (keydown)="handleKeydown($event)" style="max-height: 200px; height: 38px;" #scrollingTextarea
          [disabled]="isChatLoading"></textarea>
        <button class="send-button" [disabled]="!isSendButtonEnabled" (click)="sendMessage()">
          <ng-container *ngIf="!isChatLoading || isGeneratingAnswer; else loadingIndicator">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
              <path class="send-icon"
                d="M16.1401 2.96004L7.11012 5.96004C1.04012 7.99004 1.04012 11.3 7.11012 13.32L9.79012 14.21L10.6801 16.89C12.7001 22.96 16.0201 22.96 18.0401 16.89L21.0501 7.87004C22.3901 3.82004 20.1901 1.61004 16.1401 2.96004ZM16.4601 8.34004L12.6601 12.16C12.5101 12.31 12.3201 12.38 12.1301 12.38C11.9401 12.38 11.7501 12.31 11.6001 12.16C11.3101 11.87 11.3101 11.39 11.6001 11.1L15.4001 7.28004C15.6901 6.99004 16.1701 6.99004 16.4601 7.28004C16.7501 7.57004 16.7501 8.05004 16.4601 8.34004Z"
                [style.fill]="isSendButtonEnabled ? '#000' : '#B0B0B0'" />
            </svg>
          </ng-container>
          <ng-template #loadingIndicator>
            <div class="typing-dots">
              <span></span>
              <span></span>
              <span></span>
            </div>
          </ng-template>
        </button>
      </div>
      <!--</div>-->
    </div>
  </div>

  <button class="floating-button" *ngIf="showScrollToBottom" (click)="scrollToBottom()">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
      viewBox="0 0 24 24" stroke="currentColor" class="h-4 w-4 m-1">
      <line x1="12" y1="5" x2="12" y2="19"></line>
      <polyline points="19 12 12 19 5 12"></polyline>
    </svg>
  </button>

</div>